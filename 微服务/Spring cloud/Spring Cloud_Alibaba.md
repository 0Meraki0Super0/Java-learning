![[Pasted image 20240105191744.png]]
**业务拆分+负载均衡**

### 核心组件介绍
![[Pasted image 20240105195552.png]]
- **``LoadBalancer``**: 分为集中式，进程式——负载均衡
	- 集中式：在服务的消费方，提供方间使用独立LB设施（硬件/软件Nginx），由该设施转发请求
	- 进程式：将LB逻辑集成到消费方，消费方从服务注册中心获知服务地址，并进行访问
- **``Ribbon``**：**客户端**负载均衡工具，负责**负载均衡+RestTemplate调用**，属于进程式LB。负载均衡算法如下：
	- **RoundRobinRule（轮询规则）**：这是最简单的负载均衡算法，它按顺序一个接一个地向每个服务器发送请求。当列表结束时，算法会从头开始。
	- **RandomRule（随机规则）**：如其名，这个算法会随机选择服务器进行请求。这种方法不考虑服务器的实际负载或性能。
	-  **RetryRule（重试规则）**：这个规则在Ribbon客户端尝试服务调用时，如果上一个服务器无法成功处理请求，则会重试其他服务器。
	- **BestAvailableRule（最低并发规则）**：这个规则会尝试找到并发请求最少的服务器。该算法试图通过选择最少负载的服务器来优化服务的利用率。
	- **AvailabilityFilteringRule（可用过滤规则）**：这个算法会过滤掉那些因为多次连接失败或并发连接数过高而被认为是不可用的服务器，然后对剩余的服务器进行轮询。
	- **WeightedResponseTimeRule（响应时间加权规则）**：这个规则会根据服务器的平均响应时间计算其权重。服务器的响应时间越快，被选择的几率就越高。这种方法可以提高快速服务器的流量，从而优化整体的响应时间。
	- **ZoneAvoidanceRule（区域权衡规则）**：这个规则会综合服务器的性能和服务区域的可用性来选择服务器。它旨在在保证服务质量的同时，实现跨区域的请求分配。

- **`GateWay`**：是Spring生态上构建的API网关服务，对外提供统一调用接口，根据不同的请求转发到对应的后端。可实现负载均衡，限流，熔断，鉴权，日志，反向代理。
	- 动态路由：
	- 对路由指定Predicate（断言）:判断请求URL是否匹配(各种规则)，Filter（过滤器）
	- 集成了Hystrix的断路器
	- 请求限流
	- 路径重写
- **`Nacos`**：是服务注册中心。适用Java8
- **`Open Feign`**：进行微服务之间的调用
- **`Sleuth/Zipkin`**：Sleuth是SpringCloud原生组件，提供了完整的服务跟踪解决方案，且兼容Zipkin
- 
- RestTemplate：是Spring容器提供的用于访问rest服务的模板类。提供多种访问远程HTTP服务的方法（需要通过@Bean在配置类注入）
- 开发